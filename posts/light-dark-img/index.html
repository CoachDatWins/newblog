<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<title>
    
    Dark and Light mode images on Hugo | Francesco Tomaselli
    
</title>



<link rel="stylesheet" href="/assets/combined.min.c3083bdd3c19496ed0d975ef00b949dfc1c0a6c9e8ba82b9b74ab94356bc6503.css" media="all">




  



  </head>

  

  
  
  

  <body class="auto">

    <div class="content">
      <header>
        

<div class="header">
    <h1 class="header-title">Francesco Tomaselli</h1>

    <div class="flex">
        

        
        
        <p class="small ">
            <a href="/">
                /home
            </a>
        </p>
        
        <p class="small ">
            <a href="/posts">
                /posts
            </a>
        </p>
        
        <p class="small ">
            <a href="/about">
                /about
            </a>
        </p>
        
        
    </div>

</div>
      </header>

      <main class="main">
        




<div class="breadcrumbs">
    
    <a href="/">Home</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a href="/posts/">Posts</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a class="breadcrumbs-current" href="/posts/light-dark-img/">Dark and Light mode images on Hugo</a>
</div>


<div  class="autonumber" >

  <div class="single-intro-container">

    

    <h1 class="single-title">Dark and Light mode images on Hugo</h1>
    
    <p class="single-summary">Auto-switch images based on theme.</p>
    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2024-05-20T00:00:00&#43;00:00">May 20, 2024</time>
      

      
      &nbsp; · &nbsp;
      2 min read
      
    </p>

  </div>

  

  

  
  <aside class="toc">
    <p><strong>Table of contents</strong></p>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#the-problem">The Problem</a></li>
    <li><a href="#solution">Solution</a></li>
    <li><a href="#code">Code</a></li>
  </ul>
</nav>
  </aside>
  

  

  <div class="single-content">
    <h2 id="the-problem">The Problem</h2>
<p>During the writing of my first blog post, I found a problem with images. The drawings I made are png with a transparent background, and, since the lines are black, they look horrible on dark mode, as you can see below.</p>
<p>






<figure class="">
    <img loading="lazy" alt="img" src=" img.webp">
</figure></p>
<p>I wanted a quick way to define light and dark mode images for Hugo.</p>
<h2 id="solution">Solution</h2>
<p>GitHub lets users specify in which theme they want readme images with two tags:</p>
<pre tabindex="0"><code>![img](./dark.png#gh-dark-mode-only)
![img](./light.png#gh-light-mode-only)
</code></pre><p>I decided to do something similar, definining two tags, <code>#dark</code>, and <code>#light</code>.</p>
<pre tabindex="0"><code>![img](./dark.png#dark)
![img](./light.png#light)
</code></pre><p>What’s left is to tweak the hugo image render function to accomplish this.</p>
<h2 id="code">Code</h2>
<p>Hugo renders images with the logic defined in:</p>
<pre tabindex="0"><code>/layouts/_default/_markup/render-image.html
</code></pre><p>We can override it and decide which class to apply to an image based on the final tag:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{ $url := .Destination | safeURL }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{ $class := &#34;&#34; }}
</span></span><span style="display:flex;"><span>{{ $file_name_array :=split $url &#34;#&#34; }}
</span></span><span style="display:flex;"><span>{{ $file_name_len :=len $file_name_array }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{ if eq (index $file_name_array (sub $file_name_len 1)) &#34;dark&#34; }}
</span></span><span style="display:flex;"><span>    {{ $class = &#34;img-dark&#34; }}
</span></span><span style="display:flex;"><span>{{ else if eq (index $file_name_array (sub $file_name_len 1)) &#34;light&#34; }}
</span></span><span style="display:flex;"><span>    {{ $class = &#34;img-light&#34; }}
</span></span><span style="display:flex;"><span>{{end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="font-weight:bold">figure</span> class=<span style="font-style:italic">&#34;{{ $class }}&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="font-weight:bold">img</span> loading=<span style="font-style:italic">&#34;lazy&#34;</span> alt=<span style="font-style:italic">&#34;{{ .Text }}&#34;</span> src=<span style="font-style:italic">&#34; {{ $url }}&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="font-weight:bold">figure</span>&gt;
</span></span></code></pre></div><p>Finally, we need to define two image classes in our CSS as follows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span>.<span style="font-weight:bold">dark</span> .<span style="font-weight:bold">img-light</span> {
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">display</span>: <span style="font-weight:bold">none</span> <span style="">!important</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="font-weight:bold">light</span> .<span style="font-weight:bold">img-dark</span> {
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">display</span>: <span style="font-weight:bold">none</span> <span style="">!important</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Where dark and light classes define color schemes.</p>
<p>This solution is currently implemented in the <a href="https://github.com/tomfran/typo">Typo theme</a>, which is in use on this website, go have a look!</p>
<p>I hope this was useful, thank you for reading!</p>

    
  </div>

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


      </main>
    </div>

    <footer>
      <p>Powered by
    <a href="https://gohugo.io/">Hugo</a>
    and
    <a href="https://github.com/tomfran/typo">tomfran/typo</a>
</p>


    </footer>

  </body>

  <script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>

</html>